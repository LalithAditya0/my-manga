<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Viewer - Shattered Horizons</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <!-- Navigation bar -->
  <nav class="nav-bar">
    <a href="../index.html" class="nav-btn">ğŸ  Home</a>
    <a href="index.html" class="nav-btn">ğŸ“– Chapters</a>
    <a id="prev-chapter" class="nav-btn">â¬… Prev</a>
    <a id="next-chapter" class="nav-btn">Next â¡</a>
    <button id="mode-toggle"></button>
  </nav>

  <h1 id="chapter-title">Loading...</h1>
  <div id="pages"></div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const chapter = parseInt(urlParams.get('chapter') || "1", 10);

    const pagesDiv = document.getElementById("pages");
    const title = document.getElementById("chapter-title");
    title.textContent = "Chapter " + chapter;

    // âœ… Load images in correct order
    let page = 1;
    function loadPage(num) {
      const img = new Image();
      img.src = `manga/chapter${chapter}/page${num}.png`;
      img.alt = `Page ${num}`;

      img.onload = () => {
        pagesDiv.appendChild(img);
        loadPage(num + 1); // load next only if this exists
      };
      img.onerror = () => {}; // stop when page doesn't exist
    }
    loadPage(1);

    // âœ… Setup navigation
    const nextBtn = document.getElementById("next-chapter");
    const prevBtn = document.getElementById("prev-chapter");

    nextBtn.href = `viewer.html?chapter=${chapter + 1}`;
    if (chapter > 1) {
      prevBtn.href = `viewer.html?chapter=${chapter - 1}`;
    } else {
      prevBtn.style.display = "none"; // hide on chapter 1
    }
  </script>

  <!-- Theme toggle -->
  <script src="../theme.js"></script>
</body>
</html>
